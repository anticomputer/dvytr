# DevYeeter Configuration Example
# Copy this file to .dvytr.conf in your project directory and customize as needed

# Custom container name (optional)
# If not set, it will be generated from the current directory name
# CONTAINER_NAME="my-project-dev"

# Docker port mappings (host_port:container_port)
# Maps host machine ports to container ports
# Example: "8080:3000" means host port 8080 -> container port 3000
DOCKER_PORT_MAPPINGS=(
    # "8080:8080"   # Web server
    # "3000:3000"   # Node.js dev server
    # "5432:5432"   # PostgreSQL
    # "6379:6379"   # Redis
)

# Socat port forwarding inside container (optional, rarely needed)
# Format: "container_listen_port:target_host:target_port"
# Use this ONLY when a service binds to localhost and cannot be configured otherwise.
# For most dev servers (Vite, Next.js, etc.), use --host 0.0.0.0 flag instead!
# Example: "3001:127.0.0.1:3000" forwards container 0.0.0.0:3001 -> 127.0.0.1:3000
SOCAT_FORWARDS=(
    # "3001:127.0.0.1:3000"  # Forward to localhost-bound service
)

# Environment variables
# Set environment variables inside the container
ENV_VARS=(
    # "NODE_ENV=development"
    # "DEBUG=true"
    # "API_KEY=your-api-key"
    # "DATABASE_URL=postgres://localhost/mydb"
)

# Additional volume mounts
# Mount additional directories into the container
ADDITIONAL_VOLUMES=(
    # "/host/path:/container/path"
    # "$HOME/.ssh:/home/dev/.ssh:ro"  # SSH keys (read-only)
    # "$HOME/.gitconfig:/home/dev/.gitconfig:ro"  # Git config (read-only)
    # "$HOME/.aws:/home/dev/.aws:ro"  # AWS credentials/config (read-only)
    # "$HOME/.npmrc:/home/dev/.npmrc:ro"  # npm config for private registries (read-only)
    # "/var/run/docker.sock:/var/run/docker.sock"  # Docker socket for docker/docker-compose commands
)

# Additional PATH directories
# Add project directories to PATH (relative to /workspace)
# Useful for projects with custom scripts or binaries in subdirectories
PATH_DIRS=(
    # "bin"           # Adds /workspace/bin to PATH
    # "scripts"       # Adds /workspace/scripts to PATH
    # "node_modules/.bin"  # Adds /workspace/node_modules/.bin to PATH
    # ".dvytr/dependencies/bin"  # Common location for init script dependencies
    # "/absolute/path"     # Absolute paths are also supported
)

# Initialization script
# Path to a bash script that runs once on first container start
# Useful for building dependencies or setting up the workspace
# The script runs as the dev user after UID/GID mapping
# A marker file at .dvytr/.initialized prevents re-running
INIT_SCRIPT=""
# INIT_SCRIPT=".dvytr/init.sh"

# Example init script that builds a Go binary:
# #!/bin/bash
# set -e
# echo "Building project dependencies..."
# mkdir -p .dvytr/dependencies/bin
# GOBIN="$(pwd)/.dvytr/dependencies/bin" go install github.com/example/tool@latest
# echo "Dependencies installed to .dvytr/dependencies/bin"
#
# Then add to PATH_DIRS: ".dvytr/dependencies/bin"

# Note: The current working directory is automatically mounted to /workspace
# All configuration values are optional

# ==============================================================================
# ADVANCED EXAMPLES
# ==============================================================================

# Example: Node.js project with PostgreSQL and AWS access
# CONTAINER_NAME="my-node-app"
# DOCKER_PORT_MAPPINGS=("3000:3000" "5432:5432")
# ENV_VARS=(
#     "NODE_ENV=development"
#     "DATABASE_URL=postgres://user:pass@host.docker.internal:5432/mydb"
#     "AWS_PROFILE=my-profile"
# )
# ADDITIONAL_VOLUMES=(
#     "$HOME/.aws:/home/dev/.aws:ro"
#     "/var/run/docker.sock:/var/run/docker.sock"
# )

# Example: Monorepo with private npm packages
# CONTAINER_NAME="my-monorepo"
# DOCKER_PORT_MAPPINGS=("8080:8080")
# ENV_VARS=(
#     "PNPM_HOME=/home/dev/.local/share/pnpm"
# )
# ADDITIONAL_VOLUMES=(
#     "$HOME/.npmrc:/home/dev/.npmrc:ro"
# )

# Example: Vite dev server (recommended: use VITE_HOST env var)
# CONTAINER_NAME="my-vite-app"
# DOCKER_PORT_MAPPINGS=("5173:5173")
# ENV_VARS=(
#     "VITE_HOST=0.0.0.0"
# )
# Then run: pnpm dev (or npm run dev, vite, etc.)
#
# Alternative approaches:
# 1. Use --host flag: vite --host 0.0.0.0
# 2. If you can't configure the service at all:
#    DOCKER_PORT_MAPPINGS=("5173:5174")
#    SOCAT_FORWARDS=("5174:127.0.0.1:5173")
